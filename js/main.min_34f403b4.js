var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(n,o){function s(t){try{l(r.next(t))}catch(e){o(e)}}function a(t){try{l(r["throw"](t))}catch(e){o(e)}}function l(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(s,a)}l((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return r([t,e])}}function r(i){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(s=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=e.call(t,l)}catch(r){i=[6,r],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},DialogBaseView=function(t){function e(){var e=t.call(this)||this;return e.needShowAndCloseEff=!0,e.appeared=!1,e.needCloseSound=!0,e.hasAddedToStage=!1,e.hasCreateComplete=!1,e.width=Global.stageWidth,e.height=Global.stageHeight,e.x=e.anchorOffsetX=Global.stageWidth>>1,e.y=e.anchorOffsetY=Global.stageHeight>>1,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onRemoveFromStage,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.show=function(t,e){void 0===e&&(e=!0),this._data=t,this.needShowAndCloseEff=e},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.needCloseSound&&SoundPlayer.instance.playEffect("eff_close"),this.needShowAndCloseEff?[4,this.doCloseEffect()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.clear(),this.parent.removeChild(this),[2]}})})},e.prototype.clear=function(){this._data=null},e.prototype.onAddToStage=function(){this.hasAddedToStage=!0,this.stage.addEventListener(egret.Event.RESIZE,this.onStageResize,this),this.refresh()},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.hasCreateComplete=!0,this.initView(),this.refresh()},e.prototype.initView=function(){},e.prototype.addEvents=function(){},e.prototype.removeEvents=function(){},e.prototype.updateWindow=function(t){},e.prototype.appear=function(){this.needShowAndCloseEff?this.doShowEffect():this.appeared=!0},e.prototype.onRemoveFromStage=function(){this.hasAddedToStage&&this.hasCreateComplete&&this.removeEvents(),this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this),this.stage.removeEventListener(egret.Event.RESIZE,this.onStageResize,this),this.hasAddedToStage=!1},Object.defineProperty(e.prototype,"useEffectView",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.onStageResize=function(){this.width=Global.stageWidth,this.height=Global.stageHeight},e.prototype.refresh=function(){this.hasAddedToStage&&this.hasCreateComplete&&(this.addEvents(),this.updateWindow(this.data),this.appear())},e.prototype.doShowEffect=function(){var t=this;this.useEffectView.scaleX=this.useEffectView.scaleY=.9,egret.Tween.get(this.useEffectView).to({scaleX:1,scaleY:1},100).call(function(){t.appeared=!0},this)},e.prototype.doCloseEffect=function(){var t=this;return new Promise(function(e,i){egret.Tween.get(t.useEffectView).to({alpha:.5},100).call(function(){e()},t)})},e}(eui.Component);__reflect(DialogBaseView.prototype,"DialogBaseView");var DateUtils=function(){function t(){}return t.isLeapYear=function(t){var e=t.getFullYear();return e%400==0||e%4==0&&e%100!=0},t.isWeekDay=function(e){return!t.isWeekEnd(e)},t.isWeekEnd=function(t){var e=t.getDay();return 0==e||6==e},t.getYesterday=function(){var t=new Date;return t.setDate(t.getDate()-1),t},t.getTomorrow=function(){var t=new Date;return t.setDate(t.getDate()+1),t},t.formatDate=function(e,i){return void 0===e&&(e=null),void 0===i&&(i="#y/#l/#d #h:#m:#s"),null==e&&(e=new Date),i=t.replaceTemplate(i,"#y",e.getFullYear(),4),i=t.replaceTemplate(i,"#l",e.getMonth()+1,2),i=t.replaceTemplate(i,"#d",e.getDate(),2),i=t.replaceTemplate(i,"#h",e.getHours(),2),i=t.replaceTemplate(i,"#m",e.getMinutes(),2),i=t.replaceTemplate(i,"#s",e.getSeconds(),2)},t.formatTimestamp=function(e,i){void 0===i&&(i="#y/#l/#d #h:#m:#s");var r=new Date;return r.setTime(e),t.formatDate(r,i)},t.formatCountdown=function(e,i,r){void 0===r&&(r="#h:#m:#s");var n="",o=Math.floor(e/t.MILLIS_PER_DAY);o>0&&(n=o+i),n+=r,e%=t.MILLIS_PER_DAY;var s=Math.floor(e/t.MILLIS_PER_HOUR);n=t.replaceTemplate(n,"#h",s,2),e%=t.MILLIS_PER_HOUR;var a=Math.floor(e/t.MILLIS_PER_MINUTE);n=t.replaceTemplate(n,"#m",a,2),e%=t.MILLIS_PER_MINUTE;var l=Math.floor(e/t.MILLIS_PER_SECOND);return n=t.replaceTemplate(n,"#s",l,2)},t.replaceTemplate=function(t,e,i,r){if(void 0===r&&(r=-1),-1!=t.indexOf(e)){var n=i.toString();return-1!=r&&(n=StringUtils.leftFill(n,r-n.length)),t.replace(e,n)}return t},t.getUnixTimeStamp=function(){var t=new Date;return t.getTime()/1e3},t.MONTHS_PER_YEAR=12,t.DAYS_PER_WEEK=7,t.HOURS_PER_DAY=24,t.MINUTES_PER_HOUR=60,t.SECONDS_PER_MINUTE=60,t.MILLIS_PER_SECOND=1e3,t.MILLIS_PER_MINUTE=t.SECONDS_PER_MINUTE*t.MILLIS_PER_SECOND,t.MILLIS_PER_HOUR=t.MINUTES_PER_HOUR*t.MILLIS_PER_MINUTE,t.MILLIS_PER_DAY=t.HOURS_PER_DAY*t.MILLIS_PER_HOUR,t}();__reflect(DateUtils.prototype,"DateUtils");var Point=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t}();__reflect(Point.prototype,"Point");var ConfigProxy=function(){function t(){}return t.getConfig_TiledMap=function(t){if(this.tiledMap||(this.tiledMap={},this.getConfig_ObjMap()),!this.tiledMap[t]){var e=RES.getRes("tile_map_"+t),i={col:e.width,row:e.height,tileheight:e.tileheight-0,tilewidth:e.tilewidth-0,mapHeight:(e.tileheight-0)*e.height,mapWidth:(e.tilewidth-0)*e.width,tiles:[],objectMap:this.objMap[t]},r=void 0,n=void 0,o=void 0;for(r=0;r<e.layers.length;r++){var s=e.layers[r].data;for(i.tiles[r]=[],n=0;n<e.width;n++){var a=[];for(o=0;o<e.height;o++){var l=s[o*e.width+n],h={col:n,row:o,pId:l,x:n*i.tilewidth,y:i.tileheight*o,layer:r};a[o]=h}i.tiles[r][n]=a}}this.tiledMap[t]=i}return this.tiledMap[t]},t.getConfig_ObjMap=function(){var t=RES.getRes("ObjMapConfig");this.objMap={};for(var e in t){for(var i={},r=0,n=t[e].obj;r<n.length;r++){var o=n[r];i[o.pId]=o}this.objMap[e]=i;for(var s=0,a=t[e].obj;s<a.length;s++)for(var l=a[s],h=0,c=l.path;h<c.length;h++){var o=c[h];-1==i[o].path.indexOf(l.pId)&&i[o].path.push(l.pId)}}},t.getConfig_ObjSpec=function(t){return this.tiledMap||(this.tiledMap={},this.getConfig_ObjMap()),this.objMap[t.split("_")[0]][t]},t.objMap={},t}();__reflect(ConfigProxy.prototype,"ConfigProxy");var GameLoop=function(t){function e(){var e=t.call(this)||this;return e.layerDialog=new egret.DisplayObjectContainer,e.addChild(e.layerDialog),e.layerAlarm=new egret.DisplayObjectContainer,e.addChild(e.layerAlarm),e.layerGuide=new egret.DisplayObjectContainer,e.addChild(e.layerGuide),e.layerBlocker=new egret.DisplayObjectContainer,e.addChild(e.layerBlocker),e.layerFloatText=new egret.DisplayObjectContainer,e.addChild(e.layerFloatText),DialogLayerManager.inst.setLayer(e.layerDialog),AlarmLayerManager.inst.setLayer(e.layerAlarm),Blocker.init(e.layerBlocker),AllController.initAll(),FloatText.instance.setViewLayer(e.layerFloatText),BroadcastText.instance.setViewLayer(e.layerFloatText),e.nFrameCount=0,e.addEventListener(egret.Event.ENTER_FRAME,e.loop,e),eui.Scroller.scrollThreshold=10,e.showMainView(),e}return __extends(e,t),e.prototype.showMainView=function(){DialogLayerManager.inst.showDialog(ScoreCalculaterMainView,null,!1)},e.prototype.loop=function(t){},e.prototype.addDialog=function(t){this.layerDialog.removeChildren(),t.width=Global.stageWidth,t.height=Global.stageHeight,this.layerDialog.addChild(t)},e.prototype.removeDialog=function(){this.layerDialog.removeChildren()},e.prototype.gameEnd=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.loop,this)},e}(egret.DisplayObjectContainer);__reflect(GameLoop.prototype,"GameLoop");var Global=function(){function t(){}return t.FRAME_RATE=30,t.FRAME_RATE_SCALE=1,t.FRAME_REAL_RATE=t.FRAME_RATE*t.FRAME_RATE_SCALE,t.TIMELENGTH_PER_FRAME=1e3/t.FRAME_RATE_SCALE,t.ORIGINAL_WIDTH=1136,t.ORIGINAL_HEIGHT=640,t.MONITOR_PORTRAIT=!0,t.TEST=!1,t.colorMatrix=[1,0,0,0,100,0,1,0,0,100,0,0,1,0,100,0,0,0,1,0],t.colorFilter=[new egret.ColorMatrixFilter(t.colorMatrix)],t.glowFilter=[new egret.GlowFilter(3394815,1,35,35,2)],t.grayMatrix=[.212671,.71516,.072169,0,0,.212671,.71516,.072169,0,0,.212671,.71516,.072169,0,0,0,0,0,1,0],t.grayFilter=[new egret.ColorMatrixFilter(t.grayMatrix)],t.dropShadowFilter=[new egret.DropShadowFilter(2,45,0,.7,4,4,1.4,1)],t}();__reflect(Global.prototype,"Global");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.EVENT_CREATE_COMPLETE="EVENT_CREATE_COMPLETE",e}return __extends(e,t),e.prototype.createView=function(){var t=new egret.TextField;t.x=this.stage.stageWidth-200>>1,t.y=this.stage.stageHeight-130,t.width=200,t.textAlign="center",t.textColor=15595519,t.fontFamily="SimHei",t.size=16,this.addChild(t),this.textField=t;var e=this.graphics;e.beginFill(0),e.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),e.endFill();var i=new egret.ImageLoader;i.once(egret.Event.COMPLETE,this.logoLoadHandler,this),i.load("logo.png")},e.prototype.logoLoadHandler=function(t){var e=t.currentTarget,i=e.data,r=new egret.Texture;r.bitmapData=i;var n=new egret.Bitmap(r);this.addChild(n),n.x=this.stage.stageWidth-i.width>>1,n.y=(this.stage.stageHeight-i.height>>1)-60;var o=new egret.ImageLoader;o.once(egret.Event.COMPLETE,this.loadingLoadHandler,this),o.load("loading.png");var s=new egret.ImageLoader;s.once(egret.Event.COMPLETE,this.loadingLoadProcessHandler,this),s.load("loadingprocess.png")},e.prototype.loadingLoadHandler=function(t){var e=t.currentTarget,i=e.data,r=new egret.Texture;r.bitmapData=i;var n=new egret.Bitmap(r);this.addChild(n),n.x=this.stage.stageWidth>>1,n.y=this.stage.stageHeight-90,n.anchorOffsetX=i.width>>1,n.anchorOffsetY=i.height>>1,this.imgLoading=n,this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.dispatchEvent(new egret.Event(this.EVENT_CREATE_COMPLETE))},e.prototype.loadingLoadProcessHandler=function(t){var e=t.currentTarget,i=e.data,r=new egret.Texture;r.bitmapData=i;var n=new egret.Bitmap(r);this.addChild(n),n.x=this.stage.stageWidth>>1,n.y=this.stage.stageHeight-90,n.anchorOffsetX=i.width>>1,n.anchorOffsetY=i.height>>1,n.width=0,this.imgLoadingProcess=n,this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.dispatchEvent(new egret.Event(this.EVENT_CREATE_COMPLETE))},e.prototype.onEnterFrame=function(){},e.prototype.onProgress=function(t,e){this.textField.text="游戏加载中...50"+Math.floor(t/e*50),this.imgLoadingProcess.width=this.imgLoading.width*(t/e)},e.prototype.clear=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),RES.setMaxLoadingThread(4);var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.startCreateScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),t=new LoadingUI,this.stage.addChild(t),[4,this.createLoading(t)];case 1:return i.sent(),[4,RES.loadConfig("default.res.json",platform.getResourceRoot()+"resource/")];case 2:return i.sent(),[4,this.loadTheme()];case 3:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 4:return i.sent(),t.clear(),this.stage.removeChild(t),[3,6];case 5:return e=i.sent(),console.error(e),[3,6];case 6:return[2]}})})},e.prototype.createLoading=function(t){var e=this;return new Promise(function(i,r){t.createView(),t.addEventListener(t.EVENT_CREATE_COMPLETE,function(){i()},e)})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var r=new eui.Theme("resource/default.thm.json",t.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.startCreateScene=function(){Global.stageWidth=this.stage.stageWidth,Global.stageHeight=this.stage.stageHeight,console.log("this.stage.stageWidth:"+this.stage.stageWidth),console.log("this.stage.stageHeight:"+this.stage.stageHeight),new Global,this.gameLoop=new GameLoop,this.addChild(this.gameLoop),this.stage.addEventListener(egret.Event.RESIZE,this.onCustomResize,this)},e.prototype.onCustomResize=function(){Global.stageWidth=this.stage.stageWidth,Global.stageHeight=this.stage.stageHeight},e}(eui.UILayer);__reflect(Main.prototype,"Main");var JSONProcessor=function(){function t(){}return t.prototype.onLoadStart=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(r){return-1==e.url.indexOf("config/")?[2,t.load(e,RES.processor.JsonProcessor)]:(this.totalContent||(i="config_combine",this.totalContent=RES.getRes(i)),this.totalContent[e.name]?[2,this.totalContent[e.name]]:[2,t.load(e,RES.processor.JsonProcessor)])})})},t.prototype.onRemoveStart=function(t,e){return Promise.resolve()},t}();__reflect(JSONProcessor.prototype,"JSONProcessor",["RES.processor.Processor"]);var IMGProcessor=function(){function t(){}return t.prototype.onLoadStart=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(r){return 0!=e.url.indexOf("game_assets/")&&0!=e.url.indexOf("assets/")?[2,t.load(e,RES.processor.ImageProcessor)]:(i=e.name+"_icmb",RES.hasRes(i)?[2,RES.getRes(i)]:[2,t.load(e,RES.processor.ImageProcessor)])})})},t.prototype.onRemoveStart=function(t,e){if(0==e.url.indexOf("game_assets/")||0==e.url.indexOf("assets/")){var i=e.name+"_icmb";if(RES.hasRes(i))return RES.destroyRes(i),Promise.resolve()}return t.unload(e),Promise.resolve()},t}();__reflect(IMGProcessor.prototype,"IMGProcessor",["RES.processor.Processor"]);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,r){function n(t){e.call(r,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(r))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(r,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var l=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(r,generateJSON.paths[t])},this):RES.getResByUrl(l,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(r,generateJSON.paths[t])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var UserVO=function(){function t(){if(this.userId="temp999999",!t.canMake)throw new Error("single instance!!")}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this.canMake=!0,this._instance=new t,this.canMake=!1),this._instance},enumerable:!0,configurable:!0}),t.canMake=!1,t}();__reflect(UserVO.prototype,"UserVO");var AlarmLayerManager=function(){function t(){if(!t.canMake)throw new Error("single instance!!");this.dialogManager=new DialogManager}return Object.defineProperty(t,"inst",{get:function(){return null==t._instance&&(t.canMake=!0,t._instance=new t,t.canMake=!1),t._instance.dialogManager},enumerable:!0,configurable:!0}),t.canMake=!1,t}();__reflect(AlarmLayerManager.prototype,"AlarmLayerManager");var Blocker=function(){function t(){}return t.init=function(t){this.layer=t,this.rectBlock=new egret.Bitmap(RES.getRes("pure_black")),this.rectBlock.width=Global.stageWidth,this.rectBlock.height=Global.stageHeight,this.rectBlock.smoothing=!1,this.rectBlock.alpha=.01,this.rectBlock.visible=!1,this.count=0,this.rectBlock.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.rectBlock.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this),this.layer.addChild(this.rectBlock)},t.dispose=function(){this.count=0,this.rectBlock.stage.removeEventListener(egret.Event.RESIZE,this.onStageResize,this),this.layer.removeChild(this.rectBlock),this.rectBlock=null,this.layer=null},t.show=function(){this.count++,this.count>0&&(this.rectBlock.visible=!0)},t.close=function(){this.count--,this.count<=0&&(this.rectBlock.visible=!1)},t.onAddToStage=function(){this.rectBlock.stage.addEventListener(egret.Event.RESIZE,this.onStageResize,this)},t.onRemoveFromStage=function(){this.rectBlock.stage.removeEventListener(egret.Event.RESIZE,this.onStageResize,this),this.rectBlock.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this),this.rectBlock.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)},t.onStageResize=function(){this.rectBlock.width=Global.stageWidth,this.rectBlock.height=Global.stageHeight},t.count=0,t}();__reflect(Blocker.prototype,"Blocker");var AllController=function(){function t(){}return t.initAll=function(){},t}();__reflect(AllController.prototype,"AllController");var DialogLayerManager=function(){function t(){if(!t.canMake)throw new Error("single instance!!");this.dialogManager=new DialogManager}return Object.defineProperty(t,"inst",{get:function(){return null==t._instance&&(t.canMake=!0,t._instance=new t,t.canMake=!1),t._instance.dialogManager},enumerable:!0,configurable:!0}),t.canMake=!1,t}();__reflect(DialogLayerManager.prototype,"DialogLayerManager");var DialogManager=function(){function t(){}return t.prototype.setLayer=function(t){this.dialogLayer=t},t.prototype.showPromptBox=function(t,e,i,r,n,o,s,a){if(void 0===t&&(t=""),void 0===r&&(r=null),void 0===n&&(n=1),void 0===o&&(o=[]),void 0===s&&(s=!0),void 0===a&&(a="resource/game_skins/DialogBase.exml"),!this.dialogLayer)throw new Error("未通过setLayer设置容器层！");""==a&&(a="resource/game_skins/DialogBase.exml");var l=new DialogPromptbox(t,e,i,r,n,o,s,a);return l.show(null,!0),this.addDialog(l),l},t.prototype.showDialog=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=!0),!this.dialogLayer)throw new Error("未通过setLayer设置容器层！");var r=new t;return r.show(e,i),this.addDialog(r),r},t.prototype.addDialog=function(t){return this.dialogLayer.addChild(t),t},t.prototype.removeDialog=function(t){this.dialogLayer.contains(t)?t.close():egret.log("多次移除同一个Dialog")},t.prototype.hasDialog=function(){return this.dialogLayer.numChildren>0},t.prototype.getDialog=function(t){for(var e=this.dialogLayer.numChildren,i=0;e>i;i++)if(this.dialogLayer.getChildAt(i)instanceof t)return this.dialogLayer.getChildAt(i);return null},t.prototype.closeAllDialog=function(){for(var t=this.dialogLayer.numChildren,e=t-1;e>=0;e--){var i=this.dialogLayer.getChildAt(e);i.needShowAndCloseEff=!1,i.close()}},t}();__reflect(DialogManager.prototype,"DialogManager");var DialogPromptbox=function(t){function e(e,i,r,n,o,s,a,l){void 0===e&&(e=""),void 0===n&&(n=null),void 0===o&&(o=1),void 0===s&&(s=[]),void 0===a&&(a=!0),void 0===l&&(l="resource/game_skins/DialogBase.exml");var h=t.call(this)||this;return h.DEFAULT_BTN_TEXT=["确 定","取 消"],h.btnNum=1,h.skinName=l,h.text=e,h.callBack=i,h.thisObj=r,h.extraParams=n,h.btnNum=o,h.btnText=s,h.iconClose=a,h}return __extends(e,t),Object.defineProperty(e.prototype,"useEffectView",{get:function(){return this.groupDialog},enumerable:!0,configurable:!0}),e.prototype.initView=function(){t.prototype.initView.call(this),this.lblText.textFlow=(new egret.HtmlTextParser).parser(this.text),this.imgClose&&(this.iconClose?(this.imgClose.visible=!0,this.imgClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapToClose,this)):this.imgClose.visible=!1),this.initBtnName()},e.prototype.initBtnName=function(){if(this.btnNum>0){this.btnNum>2&&(this.btnNum=2),1==this.btnNum&&(this.btn0.horizontalCenter=0,this.btn1.visible=!1);for(var t=0;2>t;t++){var e=this["btn"+t];e.label=t<this.btnText.length?this.btnText[t]:this.DEFAULT_BTN_TEXT[t],e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapToClose,this)}}else this.btn0.visible=this.btn1.visible=!1},e.prototype.tapToClose=function(t){return __awaiter(this,void 0,void 0,function(){var i,r,n;return __generator(this,function(o){switch(o.label){case 0:switch(i=t.currentTarget,r=-1,i){case this.btn0:r=e.YES,SoundPlayer.instance.playEffect("eff_ok");break;case this.btn1:r=e.NO,SoundPlayer.instance.playEffect("eff_close");break;case this.imgClose:r=e.CLOSE,SoundPlayer.instance.playEffect("eff_close")}return[4,this.close()];case 1:return o.sent(),null!=this.callBack&&(n=this.extraParams?[r,this.extraParams]:[r],this.callBack.apply(this.thisObj,n),this.callBack=null,this.thisObj=null,this.extraParams=null),[2]}})})},e.CLOSE=-1,e.YES=0,e.NO=1,e}(DialogBaseView);__reflect(DialogPromptbox.prototype,"DialogPromptbox");var ScoreController=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.showMainView=function(){DialogLayerManager.inst.showDialog(ScoreCalculaterMainView,null,!1)},t.prototype.init=function(){},t.prototype.dispose=function(){},t}();__reflect(ScoreController.prototype,"ScoreController");var TeamSkillEnum;!function(t){t[t.OneSide=0]="OneSide",t[t.TwoSide=1]="TwoSide",t[t.ThreeSide=2]="ThreeSide",t[t.Best=3]="Best"}(TeamSkillEnum||(TeamSkillEnum={}));var AttrTypeEnum;!function(t){t[t.Vo=0]="Vo",t[t.Da=1]="Da",t[t.Pe=2]="Pe"}(AttrTypeEnum||(AttrTypeEnum={}));var ScoreMemberInfoData=function(){function t(){this.teamId=0,this.clouthAdd=0,this.memberAdd=0,this.baseVo=0,this.baseDa=0,this.basePe=0,this.baseSkill=0,this.skillVo=0,this.skillDa=0,this.skillPe=0,this.isPrecious=!1,this.isDiffColor=!0}return t}();__reflect(ScoreMemberInfoData.prototype,"ScoreMemberInfoData");var ScoreUserInfoData=function(){function t(){}return t}();__reflect(ScoreUserInfoData.prototype,"ScoreUserInfoData");var ScoreCalculaterMainView=function(t){function e(){var e=t.call(this)||this;return e.skillType=-1,e.skinName=ScoreCalculaterMainSkin,e}return __extends(e,t),e.prototype.updateWindow=function(e){t.prototype.updateWindow.call(this,e),this.cbSkill0.addEventListener(egret.Event.CHANGE,this.onCbSkillChange,this),this.cbSkill1.addEventListener(egret.Event.CHANGE,this.onCbSkillChange,this),this.cbSkill2.addEventListener(egret.Event.CHANGE,this.onCbSkillChange,this),this.gpGen.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGen,this),this.checkCacheData()},e.prototype.checkCacheData=function(){if(LocalStorage.getItem("userInfo")){var t=JSON.parse(LocalStorage.getItem("userInfo"));this.initByData(t)}for(var e=0;5>e;e++){var i=this["memberInfo"+e];if(i.setId(e),LocalStorage.getItem("memberInfo"+e)){var r=JSON.parse(LocalStorage.getItem("memberInfo"+e));i.initByData(r)}}},e.prototype.saveCacheData=function(){var t=JSON.stringify(this.userInfoData);LocalStorage.setItem("userInfo",t);for(var e=0;5>e;e++){var i=this.memberDataList[e],r=JSON.stringify(i);LocalStorage.setItem("memberInfo"+e,r)}},e.prototype.onCbSkillChange=function(t){this.updateLeaderSkillData()},e.prototype.updateLeaderSkillData=function(){this.activeSkillAttrs=[];for(var t=0;3>t;t++){var e=this["cbSkill"+t];e.selected&&this.activeSkillAttrs.push(t)}switch(this.activeSkillAttrs.length){case 0:this.skillType=TeamSkillEnum.Best;break;case 1:this.skillType=TeamSkillEnum.OneSide;break;case 2:this.skillType=TeamSkillEnum.TwoSide;break;case 3:this.skillType=TeamSkillEnum.ThreeSide}},e.prototype.onTouchGen=function(t){this.getData(),this.memberDataList=[];for(var e=0;5>e;e++){var i=this["memberInfo"+e];this.memberDataList[e]=i.getData()}this.saveCacheData(),this.updateLeaderSkillData(),this.calculateAttrs(),this.calculateByLeaderSkill(),this.calculateTotal()},e.prototype.getData=function(){var t=this.userInfoData=new ScoreUserInfoData;t.skinVo=parseInt(this.lblSkinVo.text)/100,t.skinDa=parseInt(this.lblSkinDa.text)/100,t.skinPe=parseInt(this.lblSkinPe.text)/100,t.furnitureVo=parseInt(this.lblFurnitureVo.text)/100,t.furnitureDa=parseInt(this.lblFurnitureDa.text)/100,t.furniturePe=parseInt(this.lblFurniturePe.text)/100,t.furnitureSong=parseInt(this.lblFurnitureSong.text)/100,t.userScore=parseInt(this.lblUserScore.text),t.selectedCbSkill0=this.cbSkill0.selected,t.selectedCbSkill1=this.cbSkill1.selected,t.selectedCbSkill2=this.cbSkill2.selected},e.prototype.initByData=function(t){this.lblSkinVo.text=Math.round(100*t.skinVo).toString(),this.lblSkinDa.text=Math.round(100*t.skinDa).toString(),this.lblSkinPe.text=Math.round(100*t.skinPe).toString(),this.lblFurnitureVo.text=Math.round(100*t.furnitureVo).toString(),this.lblFurnitureDa.text=Math.round(100*t.furnitureDa).toString(),this.lblFurniturePe.text=Math.round(100*t.furniturePe).toString(),this.lblFurnitureSong.text=Math.round(100*t.furnitureSong).toString(),this.lblUserScore.text=t.userScore.toString(),this.cbSkill0.selected=t.selectedCbSkill0,this.cbSkill1.selected=t.selectedCbSkill1,this.cbSkill2.selected=t.selectedCbSkill2},e.prototype.calculateAttrs=function(){this.baseTotalVo=this.baseTotalDa=this.baseTotalPe=this.baseTotalSkill=this.totalClothAdd=this.totalMemberAdd=this.totalSkillVoRatio=this.totalSkillDaRatio=this.totalSkillPeRatio=this.totalSkinAdd=this.totalFurnitureVDP=this.totalFurnitureSong=this.totalSameColorAdd=0;for(var t=0;t<this.memberDataList.length;t++){var e=this.memberDataList[t];this.baseTotalVo+=e.baseVo,this.baseTotalDa+=e.baseDa,this.baseTotalPe+=e.basePe,this.baseTotalSkill+=e.baseSkill,this.totalClothAdd+=e.clouthAdd,this.totalMemberAdd+=e.memberAdd,this.totalSkillVoRatio+=e.isPrecious?.8*e.skillVo:e.skillVo,this.totalSkillDaRatio+=e.isPrecious?.8*e.skillDa:e.skillDa,this.totalSkillPeRatio+=e.isPrecious?.8*e.skillPe:e.skillPe,this.totalSkinAdd+=Math.ceil(e.baseVo*this.userInfoData.skinVo)+Math.ceil(e.baseDa*this.userInfoData.skinDa)+Math.ceil(e.basePe*this.userInfoData.skinPe),this.totalFurnitureVDP+=Math.ceil(e.baseVo*this.userInfoData.furnitureVo)+Math.ceil(e.baseDa*this.userInfoData.furnitureDa)+Math.ceil(e.basePe*this.userInfoData.furniturePe),this.totalSameColorAdd+=e.isDiffColor?0:Math.ceil(.3*e.baseVo)+Math.ceil(.3*e.baseDa)+Math.ceil(.3*e.basePe),this.totalFurnitureSong+=Math.ceil((e.baseVo+e.baseDa+e.basePe)*this.userInfoData.furnitureSong)}this.totalBaseVDP=this.baseTotalVo+this.baseTotalDa+this.baseTotalPe,this.totalUserScoreAdd=this.userInfoData.userScore/1e4*800},e.prototype.calculateByLeaderSkill=function(){switch(this.skillType){case TeamSkillEnum.OneSide:this.onSideSkill(.7);break;case TeamSkillEnum.TwoSide:this.onSideSkill(.6);break;case TeamSkillEnum.ThreeSide:this.onSideSkill(.5);break;case TeamSkillEnum.Best:this.onBestSkill()}this.stellerSkillAddVo=this.stellerSkillAddDa=this.stellerSkillAddPe=0;for(var t=0;t<this.memberDataList.length;t++){var e=this.memberDataList[t];this.stellerSkillAddVo+=Math.ceil(e.baseVo*this.stellerSkillVoRatio),this.stellerSkillAddDa+=Math.ceil(e.baseDa*this.stellerSkillDaRatio),this.stellerSkillAddPe+=Math.ceil(e.basePe*this.stellerSkillPeRatio)}},e.prototype.onSideSkill=function(t){this.userInfoData.selectedCbSkill0?this.stellerSkillVoRatio=this.totalSkillVoRatio*t:this.stellerSkillVoRatio=-1,this.userInfoData.selectedCbSkill1?this.stellerSkillDaRatio=this.totalSkillDaRatio*t:this.stellerSkillDaRatio=-1,this.userInfoData.selectedCbSkill2?this.stellerSkillPeRatio=this.totalSkillPeRatio*t:this.stellerSkillPeRatio=-1},e.prototype.onBestSkill=function(){for(var t=0,e=0,i=0,r=0;5>r;r++){var n=this.memberDataList[r];n.skillVo>t&&(t=n.skillVo),n.skillDa>e&&(e=n.skillDa),n.skillPe>i&&(i=n.skillPe)}this.stellerSkillVoRatio=.65*t,this.stellerSkillDaRatio=.65*e,this.stellerSkillPeRatio=.65*i},e.prototype.calculateTotal=function(){var t=this.totalBaseVDP+this.baseTotalSkill+this.stellerSkillAddVo+this.stellerSkillAddDa+this.stellerSkillAddPe+this.totalClothAdd+this.totalFurnitureVDP+this.totalMemberAdd+this.totalSkinAdd,e=t+this.totalSameColorAdd+this.totalFurnitureSong,i=e+this.totalUserScoreAdd;this.txtTeamScore.text=Math.ceil(t).toString(),this.txtSongScore.text=Math.ceil(e).toString(),this.txtTotalScore.text=Math.ceil(i).toString()},e}(DialogBaseView);__reflect(ScoreCalculaterMainView.prototype,"ScoreCalculaterMainView");var ScoreMemberInfoView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setId=function(t){this.lblTeamId.text="队员"+t,this.teamId=t},e.prototype.getData=function(){var t=new ScoreMemberInfoData;return t.teamId=this.teamId,t.clouthAdd=parseInt(this.lblClouth.text),t.memberAdd=parseInt(this.lblMember.text),t.baseVo=parseInt(this.lblBaseVo.text),t.baseDa=parseInt(this.lblBaseDa.text),t.basePe=parseInt(this.lblBasePe.text),t.baseSkill=parseInt(this.lblBaseSkill.text),t.skillVo=parseInt(this.lblSkillVo.text)/100,t.skillDa=parseInt(this.lblSkillDa.text)/100,t.skillPe=parseInt(this.lblSkillPe.text)/100,t.isPrecious=this.cbPrecious.selected,t.isDiffColor=this.cbDiffColor.selected,t},e.prototype.initByData=function(t){this.lblTeamId.text="队员"+t.teamId,this.lblClouth.text=t.clouthAdd.toString(),this.lblMember.text=t.memberAdd.toString(),this.lblBaseVo.text=t.baseVo.toString(),this.lblBaseDa.text=t.baseDa.toString(),this.lblBasePe.text=t.basePe.toString(),this.lblBaseSkill.text=t.baseSkill.toString(),this.lblSkillVo.text=Math.round(100*t.skillVo).toString(),this.lblSkillDa.text=Math.round(100*t.skillDa).toString(),this.lblSkillPe.text=Math.round(100*t.skillPe).toString(),this.cbPrecious.selected=t.isPrecious,this.cbDiffColor.selected=t.isDiffColor},e}(eui.Component);__reflect(ScoreMemberInfoView.prototype,"ScoreMemberInfoView");var DebugPlatform=function(){function t(){this.name="normal",this.isAdVersion=!1}return t.prototype.getQueryVariable=function(t){return window.getQueryVariable(t)},t.prototype.getResourceRoot=function(){return""},t.prototype.bannerAdAvailable=function(){return!1},t.prototype.bannerAdShow=function(t,e,i,r,n){},t.prototype.bannerAdSHide=function(){},t.prototype.videoAdAvailable=function(){return!1},t.prototype.videoAdShow=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return[2,new Promise(function(e){egret.setTimeout(function(){e(!0)
},t,3e3)})]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var AnimateUpDownButton=function(t){function e(e,i,r,n,o,s,a){var l=t.call(this)||this;l.ptTex=0;var h=new egret.Bitmap(e);return h.anchorOffsetX=h.texture.textureWidth>>1,h.anchorOffsetY=h.texture.textureHeight>>1,l.addChild(h),l.bmpBtn=h,h=new egret.Bitmap(r),h.anchorOffsetX=h.texture.textureWidth>>1,h.anchorOffsetY=h.texture.textureHeight>>1,h.y=n,h.rotation=a,l.addChild(h),l.bmpIcon=h,l.texBtn=[e,i],l.downOffset=o,l.timerId=egret.setInterval(l.onChange,l,s),l}return __extends(e,t),e.prototype.onChange=function(){this.ptTex=this.ptTex?0:1,this.bmpBtn.texture=this.texBtn[this.ptTex],this.bmpIcon.y+=this.ptTex?this.downOffset:-this.downOffset},e.prototype.dispose=function(){egret.clearInterval(this.timerId)},e}(egret.DisplayObjectContainer);__reflect(AnimateUpDownButton.prototype,"AnimateUpDownButton");var ArrayUtils=function(){function t(){}return t.findMaxValue=function(t){return Math.max.apply(null,t)},t.findMinValue=function(t){return Math.min.apply(null,t)},t.transformBlankElementToUndefine=function(t){Array.apply(null,t)},t.transformArrayLikeObjectToArray=function(t){return Array.prototype.slice.apply(t)},t.contains=function(t,e){return-1!=t.indexOf(e)},t.containsProperty=function(t,e,i){return t.some(function(t){return t[e]==i})},t.indexOfProperty=function(t,e,i){for(var r=0;r<t.length;r++)if(t[r][e]==i)return r;return-1},t.unipush=function(e,i){t.contains(e,i)||e.push(i)},t.unique=function(t){if(t.length<2)return t;for(var e=new SimpleMap,i=0;i<t.length;i++){var r=t[i];e.hasKey(r)?t.splice(i--,1):e.set(r,!0)}return t},t.removeItem=function(t,e){var i=t.indexOf(e);return-1!=i?(t.splice(i,1),e):null},t.getRandItem=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},t.shuffle=function(t){var e=t.length;if(2>e)return t;for(var i=e-1;i>=0;i--){var r=Math.floor(Math.random()*(i+1)),n=t[r];t[r]=t[i],t[i]=n}return t},t.swapItem=function(t,e,i){var r=t[e];t[e]=t[i],t[i]=r},t.flatten=function(e,i){null==i&&(i=[]);for(var r=e.length,n=0;n!=r;n++){var o=e[n];Array.isArray(o)?t.flatten(o,i):i.push(o)}return i},t.sortOn=function(e,i,r){void 0===r&&(r=t.DEFAULT);var n=Array.isArray(i)?i:[i],o=Array.isArray(r)?r:[r],s=0,a=0,l=this;return this.fixOptionsArr(n,o),e.sort(function(t,e){for(s=0,a=0;0==a&&s<n.length;){if(a=l.compareFun(t[n[s]],e[n[s]],o[s]),0!=a)return a;s++}return a}),e},t.fixOptionsArr=function(e,i){var r=i.length,n=e.length;if(n>r)for(var o=r;n>o;o++)i[o]=t.DEFAULT},t.compareFun=function(e,i,r){var n=Boolean((r&t.DESCENDING)==t.DESCENDING),o=Boolean((r&t.NUMERIC)==t.NUMERIC),s=Boolean((r&t.CASEINSENSITIVE)==t.CASEINSENSITIVE),a=o?Number(e):s?e.toString().toLocaleLowerCase():e.toString(),l=o?Number(i):s?i.toString().toLocaleLowerCase():i.toString();return a==l?0:(n?l>a:a>l)?1:-1},t.DEFAULT=0,t.CASEINSENSITIVE=1,t.DESCENDING=2,t.NUMERIC=4,t}();__reflect(ArrayUtils.prototype,"ArrayUtils");var BroadcastText=function(){function t(){if(this.COMPONENT_WIDTH=500,this.msgQueue=[],!t.canMake)throw new Error("BroadcastText is single instance!!")}return t.prototype.setViewLayer=function(t){this.textLayer=t},t.prototype.addText=function(t){this.msgQueue.push(t),1==this.msgQueue.length&&(this.generateComponnet(),this.doBroadcast())},t.prototype.generateComponnet=function(){var t=new egret.DisplayObjectContainer,e=new egret.Bitmap(RES.getRes("broadcast_bg"));e.scale9Grid=new egret.Rectangle(44,4,77,28),e.width=this.COMPONENT_WIDTH,t.addChild(e);var i=new egret.TextField;i.y=7,i.textColor=16775140,i.fontFamily="SimHei",i.size=25,i.multiline=!1,t.addChild(i),this.txtContent=i;var r=new egret.Shape;r.graphics.beginFill(16711680),r.graphics.drawRect(54,0,this.COMPONENT_WIDTH-58,50),r.graphics.endFill(),t.addChild(r),i.mask=r,this.grpComponent=t,this.textLayer.addChild(this.grpComponent),t.x=Global.stageWidth-this.COMPONENT_WIDTH>>1,t.y=220,t.alpha=0,egret.Tween.get(t).to({alpha:1},750)},t.prototype.doBroadcast=function(){var t=this;if(this.msgQueue.length){var e=this.txtContent;e.text=this.msgQueue[0],e.x=this.COMPONENT_WIDTH,egret.Tween.get(e).to({x:e.x-e.textWidth-this.COMPONENT_WIDTH},18*e.textWidth).wait(1e3).call(function(){t.msgQueue.shift(),t.doBroadcast()},this)}else this.disposeComponnet()},t.prototype.disposeComponnet=function(){var t=this;egret.Tween.get(this.grpComponent).to({alpha:0},500).call(function(){t.textLayer.removeChild(t.grpComponent),t.grpComponent=t.txtContent=null})},Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t.canMake=!0,t._instance=new t,t.canMake=!1),t._instance},enumerable:!0,configurable:!0}),t.canMake=!1,t}();__reflect(BroadcastText.prototype,"BroadcastText");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function r(r){e.call(i,r,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?r(n):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var EventCenter=function(t){function e(){var i=this;if(!e.canMake)throw new Error("single instance!!");return i=t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==e.instance&&(e.canMake=!0,e.instance=new e,e.canMake=!1),e.instance},e.canMake=!1,e}(egret.EventDispatcher);__reflect(EventCenter.prototype,"EventCenter");var FilterWords=function(){function t(){}return t.tryLoadFilterWordsConf=function(){return this.filterWords||(this.filterWords=RES.getRes("filter_words")),this.filterWords.concat()},t.checkIllegal=function(t){for(var e=this.tryLoadFilterWordsConf(),i=0,r=e;i<r.length;i++){var n=r[i];if(-1!=t.search(new RegExp(n)))return!0}return-1==t.search(new RegExp("[<>]"))?!1:!0},t.checkChatWords=function(t){for(var e=this.tryLoadFilterWordsConf(),i=0,r=e;i<r.length;i++){var n=r[i];t=t.replace(new RegExp(n,"g"),"***")}return t},t}();__reflect(FilterWords.prototype,"FilterWords");var FloatText=function(){function t(){if(this.FLOAT_POS_TOP=380,this.floatPosNow=this.FLOAT_POS_TOP,this.firstText=null,!t.canMake)throw new Error("single instance!!")}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t.canMake=!0,t._instance=new t,t.canMake=!1),t._instance},enumerable:!0,configurable:!0}),t.prototype.setViewLayer=function(t){this.textLayer=t},t.prototype.addText=function(t){var e=this,i=this.generateText(t);i.y=this.floatPosNow,i.x=Global.stageWidth-i.width>>1,i.alpha=0,this.textLayer.addChild(i),this.firstText||(this.firstText=i),egret.Tween.get(i).to({y:this.floatPosNow-25,alpha:1},300).wait(1700).to({y:this.floatPosNow-50,alpha:0},300).call(function(){e.textLayer.removeChild(i),i==e.firstText&&(e.firstText=null,e.floatPosNow=e.FLOAT_POS_TOP)},this),this.floatPosNow+=i.height+5,this.floatPosNow>Global.stageHeight-30&&(this.floatPosNow=this.FLOAT_POS_TOP)},t.prototype.generateText=function(t){var e=new egret.DisplayObjectContainer,i=new egret.TextField;i.x=0,i.y=611,i.fontFamily="SimHei",i.size=24,i.text=t,e.addChild(i);var r=new egret.Bitmap(RES.getRes("floattxt"));return r.scale9Grid=new egret.Rectangle(9,9,56,56),r.width=i.textWidth+40,r.height=i.textHeight+16,e.addChildAt(r,0),i.x=20,i.y=8,e},t.canMake=!1,t}();__reflect(FloatText.prototype,"FloatText");var Language=function(){function t(){}return t.setLanguagePack=function(t){this.langId=t;var e=this.getLangInfo(t);this.conf=RES.getRes("language_"+e.suffix)},t.text=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=this.conf[t]?this.conf[t]:t;return e.length?(e.unshift(r),StringUtils.substitute.apply(null,e)):r},t.img=function(t){t+"_"+this.suffix();return t+"_"+this.suffix()},t.suffix=function(){var t=this.getLangInfo(this.langId);return t.suffix},t.getLangInfo=function(t){return this.langInfo||(this.langInfo=RES.getRes("lang_info")),this.langInfo[t]},t}();__reflect(Language.prototype,"Language");var LanguageInfo=function(){function t(){}return t}();__reflect(LanguageInfo.prototype,"LanguageInfo");var LocalStorage=function(){function t(){}return t.getItem=function(t,e){void 0===e&&(e=!0);var i=e?this.getKeyWithUserID(t):this.getKey(t);return egret.localStorage.getItem(i)},t.setItem=function(t,e,i){void 0===i&&(i=!0);var r=i?this.getKeyWithUserID(t):this.getKey(t);return egret.localStorage.setItem(r,e)},t.removeItem=function(t,e){void 0===e&&(e=!0);var i=e?this.getKeyWithUserID(t):this.getKey(t);egret.localStorage.removeItem(i)},t.clear=function(){egret.localStorage.clear()},t.getKeyWithUserID=function(t){var e=UserVO.instance.userId;return this.GAME_KEY+"_"+e+"_"+t},t.getKey=function(t){return this.GAME_KEY+"_"+t},t.GAME_KEY="UoaToolBox",t}();__reflect(LocalStorage.prototype,"LocalStorage");var NumInputUtil=function(){function t(){this._maxNum=9999,this._minNum=0}return t.prototype.init=function(t,e,i,r,n,o,s,a,l){void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=1),void 0===a&&(a=9999),void 0===l&&(l=0),this._btnAdd=t,this._btnReduce=e,this._txtInput=i,this._callBack=r,this._callBackArgs=null==o?[]:o,this._thisObj=n,this._maxNum=a,this._minNum=l,this._btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickBtnAdd,this),this._btnReduce.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickBtnReduce,this),this._txtInput.restrict="0-9",this._txtInput.addEventListener(egret.Event.CHANGE,this.onTextChange,this),this._txtInput.text=s.toString(),this.onNumChange()},t.prototype.updateData=function(t,e,i){void 0===t&&(t=1),void 0===e&&(e=9999),void 0===i&&(i=0),this._maxNum=e,this._minNum=i,this._txtInput.text=t.toString()},t.prototype.onTextChange=function(t){this.onNumChange()},t.prototype.onClickBtnAdd=function(t){this.currNum>=this._maxNum||(this._txtInput.text=(this.currNum+1).toString(),this.onNumChange())},t.prototype.onClickBtnReduce=function(t){this.currNum<=this._minNum||(this._txtInput.text=(this.currNum-1).toString(),this.onNumChange())},t.prototype.onNumChange=function(){this.currNum>this._maxNum&&(this._txtInput.text=this._maxNum.toString()),this.currNum<this._minNum&&(this._txtInput.text=this._minNum.toString()),null!=this._callBack&&this._callBack.apply(this._thisObj,this._callBackArgs)},t.prototype.dispose=function(){this._btnAdd.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickBtnAdd,this),this._btnReduce.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickBtnReduce,this),this._txtInput.removeEventListener(egret.Event.CHANGE,this.onTextChange,this),this._btnAdd=null,this._btnReduce=null,this._txtInput=null,this._callBack=null,this._callBackArgs=null,this._thisObj=null},Object.defineProperty(t.prototype,"currNum",{get:function(){return Number(this._txtInput.text)},enumerable:!0,configurable:!0}),t}();__reflect(NumInputUtil.prototype,"NumInputUtil");var ObjectPool=function(){function t(){if(!t.canMake)throw new Error("single instance!!");this.poolDict=[]}return t.getInstance=function(){return null==t.instance&&(t.canMake=!0,t.instance=new t,t.canMake=!1),t.instance},t.prototype.getOneObj=function(t){var e=egret.getQualifiedClassName(t);null==this.poolDict[e]&&(this.poolDict[e]=[]);var i;return i=0==this.poolDict[e].length?new t:this.poolDict[e].pop()},t.prototype.releaseOneObj=function(t){var e=egret.getQualifiedClassName(t);null!=this.poolDict[e]&&this.poolDict[e].push(t)},t.prototype.clearPool=function(t){if(t){var e=egret.getQualifiedClassName(t);this.poolDict[e]=null}else this.poolDict=[]},t.canMake=!1,t}();__reflect(ObjectPool.prototype,"ObjectPool");var ScrollBackGround=function(t){function e(e,i,r){var n=t.call(this)||this;return n.speed=e,n.containerWidth=i,r&&n.setTexture(r),n}return __extends(e,t),e.prototype.setTexture=function(t){this.texture=t,this.fillMode=egret.BitmapFillMode.REPEAT;var e=Math.ceil(this.containerWidth/t.textureWidth)+1;this.width=t.textureWidth*e,this.texWidth=t.textureWidth},e.prototype.toScroll=function(){this.x-=this.speed,this.x<-this.texWidth&&(this.x=0)},e}(egret.Bitmap);__reflect(ScrollBackGround.prototype,"ScrollBackGround");var SimpleMap=function(){function t(){this.keys=[],this.values=[]}return t.prototype.hasKey=function(t){return-1!=this.keys.indexOf(t)},t.prototype.hasValue=function(t){return-1!=this.values.indexOf(t)},t.prototype.get=function(t){var e=this.keys.indexOf(t);return-1!=e?this.values[e]:void 0},t.prototype.set=function(t,e){var i=this.keys.indexOf(t);-1!=i?this.values[i]=e:(this.keys.push(t),this.values.push(e))},t.prototype["delete"]=function(t){var e=this.keys.indexOf(t);return-1!=e?(this.keys.splice(e,1),this.values.splice(e,1),!0):!1},t.prototype.forEach=function(t,e){if(this.keys.length>0)for(var i=this.keys.length-1;i>=0;i--)t.call(e,this.keys[i],this.values[i])},t.prototype.some=function(t,e){for(var i=this.keys.length,r=0;i>r;r++)if(t.call(e,this.keys[r],this.values[r]))return!0;return!1},t.prototype.filterOne=function(t,e){for(var i=this.keys.length,r=0;i>r;r++)if(t.call(e,this.keys[r],this.values[r]))return[this.keys[r],this.values[r]];return null},t.prototype.filterAll=function(t,e){for(var i=this.keys.length,r=[],n=0;i>n;n++)t.call(e,this.keys[n],this.values[n])&&r.push([this.keys[n],this.values[n]]);return r.length>0?r:null},t.prototype.clear=function(){this.keys.length=this.values.length=0},t}();__reflect(SimpleMap.prototype,"SimpleMap");var SimulateMsg=function(){function t(){}return t.insertSimulateApi=function(t,e){this.simulattingApi[t]=e},t.needSimulate=function(t){return void 0!=this.simulattingApi[t]},t.removeSimulateApi=function(t){delete this.simulattingApi[t]},t.send=function(t,e,i,r){null==e&&(e={});var n=new SimulateMsgData;n.initData(t,e,i,r),this.msgQueue.push(n),egret.setTimeout(this.onReturnMsg,this,0)},t.onReturnMsg=function(){if(0!=this.msgQueue.length){var t=this.msgQueue.shift(),e=this.simulattingApi[t.opcode].call(this,t.params);t.excuteCallBack(e)}},t.simulattingApi={},t.msgQueue=[],t}();__reflect(SimulateMsg.prototype,"SimulateMsg");var SimulateMsgData=function(){function t(){this.opcode="",this.params=null,this.callBack=null,this.thisObj=null}return t.prototype.initData=function(t,e,i,r){this.opcode=t,this.params=e,this.callBack=i,this.thisObj=r},t.prototype.clearData=function(){this.opcode="",this.params=null,this.thisObj=null,this.callBack=null},t.prototype.excuteCallBack=function(t){this.callBack.apply(this.thisObj,[t.opcode,t.message]),this.clearData()},t}();__reflect(SimulateMsgData.prototype,"SimulateMsgData");var SoundPlayer=function(){function t(){if(!t.canMake)throw new Error("single instance!!")}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t.canMake=!0,t._instance=new t,t.canMake=!1,StringUtils.isEmpty(LocalStorage.getItem("effectOn",!1))?this.instance._effectOn=!0:this.instance._effectOn="1"==LocalStorage.getItem("effectOn",!1),StringUtils.isEmpty(LocalStorage.getItem("bgmOn",!1))?this.instance._bgmOn=!0:this.instance._bgmOn="1"==LocalStorage.getItem("bgmOn",!1)),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bgmOn",{get:function(){return this._bgmOn},set:function(t){this._bgmOn=t,t?this.playBGM(this.currentBgm):this.stopBGM(!0);var e=this._bgmOn?"1":"0";LocalStorage.setItem("bgmOn",e,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectOn",{get:function(){return this._effectOn},set:function(t){this._effectOn=t;var e=this._effectOn?"1":"0";LocalStorage.setItem("effectOn",e,!1)},enumerable:!0,configurable:!0}),t.prototype.playBGM=function(t,e){void 0===e&&(e=0);var i=this;if(t&&(i.currentBgm!=t||!i.loadingSound&&!i.bgmChannel)){if(!i._bgmOn)return void(i.currentBgm=t);i.stopBGM(),i.currentBgm=t,i.loadingSound=!0,i.bgmLoops=e,RES.getResAsync(t,function(t){t&&i.loadingSound&&(i.bgmChannel=t.play(0,i.bgmLoops),i.bgmChannel.addEventListener(egret.Event.SOUND_COMPLETE,i.stopBGM,i),i.loadingSound=!1)},this)}},t.prototype.stopBGM=function(t){void 0===t&&(t=!1);var e=this;e.loadingSound?e.loadingSound=!1:e.bgmChannel&&(e.bgmChannel.removeEventListener(egret.Event.SOUND_COMPLETE,e.stopBGM,e),e.bgmChannel.stop(),e.bgmChannel=null),t||(e.currentBgm="")},t.prototype.playEffect=function(t){this.effectOn&&RES.getResAsync(t,function(t){t&&t.play(0,1)},this)},t.prototype.soundPath=function(t){var e=platform.getResourceRoot();return e+"resource/sound/"+t+".mp3"},t.canMake=!1,t}();__reflect(SoundPlayer.prototype,"SoundPlayer");var StringUtils=function(){function t(){}return t.trim=function(e){if(null==e)return"";for(var i=0;t.isWhitespace(e.charAt(i));)++i;for(var r=e.length-1;t.isWhitespace(e.charAt(r));)--r;return r>=i?e.slice(i,r+1):""},t.leftTrim=function(e){if(null==e)return"";for(var i=0;t.isWhitespace(e.charAt(i));)++i;return e.slice(i)},t.rightTrim=function(e){if(null==e)return"";for(var i=e.length,r=i-1;t.isWhitespace(e.charAt(r));)--r;return e.slice(0,r+1)},t.trimSubs=function(e,i){if(""!=e&&null!=e){for(var r=e.split(i),n=r.length,o=0;n>o;o++)r[o]=t.trim(r[o]);n>0&&(e=r.join(i))}return e},t.isWhitespace=function(t){switch(t){case" ":case"	":case"\r":case"\n":case"\f":return!0;default:return!1}},t.substitute=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(t.isEmpty(e))return"";for(var n=i.length,o=0;n>o;o++)e=e.replace(new RegExp("\\{"+o+"\\}","g"),i[o]);return e},t.isEmpty=function(t){return null==t||0==t.length},t.leftFill=function(t,e,i){void 0===i&&(i="0");for(var r=0;e>r;r++)t=i+t;return t},t.rightFill=function(t,e,i){void 0===i&&(i="0");for(var r=0;e>r;r++)t+=i;return t},t.unescape=function(t){if(!t)return"";var e=null;return e=-1!=t.indexOf("%")?decodeURI(t):t},t.getColorText=function(e,i,r,n,o,s,a){void 0===r&&(r=20),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=null);var l="<font fontfamily='{0}' size='{1}' color='{2}'>{3}</font>";null==a&&(a="SimHei");var h=t.substitute(l,a,r,i,e);return o&&(l="<u>{0}</u>",h=t.substitute(l,h)),n&&(l="<b>{0}</b>",h=t.substitute(l,h)),s&&(l="<i>{0}</i>",h=t.substitute(l,h)),h},t.getLinkText=function(e,i,r,n,o,s,a,l){void 0===r&&(r=0),void 0===n&&(n=12),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),void 0===l&&(l=null),e=t.getColorText(e,r,n,o,s,a,l);var h="<a href='event:{0}'>{1}</a>";return t.substitute(h,i,e)},t.findCharByNum=function(t,e,i){for(var r=t.indexOf(e),n=0;i>n;n++)r=t.indexOf(e,r+1);return r},t}();__reflect(StringUtils.prototype,"StringUtils");var TimeClock=function(){function t(){}return t.setServerTime=function(t,e){t+=36e5*e,this.serverTimeMark=t,this.runTimeMark=egret.getTimer(),this.timeZoneDiff=6e4*(-(new Date).getTimezoneOffset()-60*e),this.nowTime=t},t.timeTick=function(){for(this.nowTime=egret.getTimer()-this.runTimeMark+this.serverTimeMark;this.callbackQueue.length&&this.callbackQueue[0].timePt<=this.nowTime;){var t=this.callbackQueue[0];t.func.apply(t.thisObj,t.args),this.callbackQueue.shift(),t.loop&&(t.timePt+=t.length,this.insertIntoQueue(t))}},t.getServerHours=function(){var t=new Date(this.nowTime+this.timeZoneDiff);return t.getHours()},t.addTimeout=function(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var o={id:Math.random(),timePt:this.nowTime+t,loop:!1,func:e,thisObj:i,args:r};return this.insertIntoQueue(o),o.id},t.addInterval=function(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var o={id:Math.random(),timePt:this.nowTime+t,loop:!0,length:t,func:e,thisObj:i,args:r};return this.insertIntoQueue(o),o.id},t.addTimeAppointment=function(t,e,i,r){for(var n=[],o=4;o<arguments.length;o++)n[o-4]=arguments[o];var s=new Date;s.setHours(t),s.setMinutes(e),s.setTime(s.getTime()-this.timeZoneDiff),s.getTime()<this.nowTime&&s.setTime(s.getTime()+864e5);var a={id:Math.random(),timePt:s.getTime(),loop:!1,func:i,thisObj:r,args:n};return this.insertIntoQueue(a),a.id},t.getAppointmentRestTime=function(t){for(var e=0;e<this.callbackQueue.length;e++){var i=this.callbackQueue[e];if(i.id==t)return this.getTimeFormat(Math.floor((i.timePt-this.nowTime)/1e3),!1)}return""},t.removeTimeoutAndAppointment=function(t){for(var e=0;e<this.callbackQueue.length;e++){var i=this.callbackQueue[e];if(i.id==t){this.callbackQueue.splice(t,1);break}}},t.insertIntoQueue=function(t){for(var e=0;e<this.callbackQueue.length;e++){var i=this.callbackQueue[e];if(i.timePt>t.timePt)break}this.callbackQueue.splice(e,0,t)},t.getTimeFormat=function(t,e){void 0===e&&(e=!0);var i=Math.floor(t/3600);t%=3600;var r=Math.floor(t/60);t%=60;var n="";return(i>0||e)&&(n=(i>9?i:"0"+i)+":"),r>=0&&(n+=(r>9?r:"0"+r)+":"+(t>9?t:"0"+t)),n},t.runTimeMark=0,t.serverTimeMark=0,t.callbackQueue=[],t}();__reflect(TimeClock.prototype,"TimeClock");var Utils=function(){function t(){}return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.rand=function(){return t.seed=214013*t.seed+2531011&2147483647,t.seed},t.random=function(e){return(t.rand()&t.INT_MAX_VALUE)%e},t.weekDay=function(t){if(1==t.length&&0==t[0])return"每天";for(var e=["","星期一、","星期二、","星期三、","星期四、","星期五、","星期六、","星期日、"],i="",r=0,n=t;r<n.length;r++){var o=n[r];i+=e[o]}return i.substr(0,i.length-1)},t.randomKeyByWeight=function(t,e){void 0===e&&(e=!1);var i=[],r=0;for(var n in t){var o=t[n];if(o>0){var s={key:n,limit:r};i.push(s),r+=o}}for(var a=e?this.random(r):Math.random()*r,l=i.length-1;l>=0;l--)if(a>=i[l].limit)return i[l].key;return i[0].key},t.randomByRange=function(t,e){void 0===e&&(e=!1);var i=t[0],r=t[1];i>r&&egret.log("randomByRange错误:下限超过上限了");var n=r-i,o=e?this.random(n):Math.random()*n;return i+o},t.replaceStr=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(t.isEmptyStr(e))return"";for(var n=i.length,o=0;n>o;o++)e=e.replace(new RegExp("\\{"+o+"\\}","g"),i[o]);return e},t.isEmptyStr=function(t){return null==t||0==t.length},t.modifyLimit=function(t,e,i){var r;return r=e>t?e:t>i?i:t},t.modifyUpperLimit=function(t,e){return t>e?e:t},t.modifyLowerLimit=function(t,e){return e>t?e:t},t.getTextureGroup=function(t,e){for(var i=e?e:Number.MAX_VALUE,r=[],n=1;i>=n;n++){var o=RES.getRes(t+n);if(!o)break;r.push(o)}return r},t.seed=1e4,t.INT_MAX_VALUE=2147483647,t}();__reflect(Utils.prototype,"Utils");var UuidUtils=function(){function t(){}return t.uuid=function(t,e){void 0===e&&(e=0);var i,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=[];if(e=e||r.length,t)for(i=0;t>i;i++)n[i]=r[0|Math.random()*e];else{var o;for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",i=0;36>i;i++)n[i]||(o=0|16*Math.random(),n[i]=r[19==i?3&o|8:o])}return n.join("")},t}();__reflect(UuidUtils.prototype,"UuidUtils");var AnchorPointPosType=function(){function t(){}return t.getAnchorPonumberByPosType=function(t){return this.anchorPonumberDic[t]},t.anchorPonumberDic={},t.TOP_LEFT=0,t.CENTER=1,t.LEFT_CENTER=2,t.BOTTOM_LEFT=3,t.TOP_RIGHT=4,t.RIGHT_CENTER=5,t.BOTTOM_RIGHT=6,t.TOP_CENTER=7,t.BOTTOM_CENTER=8,t}();__reflect(AnchorPointPosType.prototype,"AnchorPointPosType"),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.TOP_LEFT]=new egret.Point(0,0),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.CENTER]=new egret.Point(.5,.5),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.LEFT_CENTER]=new egret.Point(0,.5),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.BOTTOM_LEFT]=new egret.Point(0,1),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.TOP_RIGHT]=new egret.Point(1,0),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.RIGHT_CENTER]=new egret.Point(1,.5),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.BOTTOM_RIGHT]=new egret.Point(1,1),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.TOP_CENTER]=new egret.Point(.5,0),AnchorPointPosType.anchorPonumberDic[AnchorPointPosType.BOTTOM_CENTER]=new egret.Point(.5,1);var BitmapMovie=function(t){function e(){var e=t.call(this)||this;return e._needLoadAssets=!1,e._currentFrame=0,e._totalFrames=0,e._reverse=!1,e._isRandom=!1,e._anchorPointType=0,e._loopCount=0,e._currRunNum=0,e._callBack=null,e._callBackParams=null,e._thisObj=null,e._fps=25,e._lastTickCount=0,e._needRnederPerFrame=!1,e._bitmapOffx=0,e._bitmap=new egret.Bitmap,e.addChild(e._bitmap),e.touchEnabled=e.touchChildren=!1,BitmapMovieManager.instance.registe(e),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this),this.startLoadAssets(),this.refresh()},e.prototype.refresh=function(){this._totalFrames=this._datas?this._datas.length:0,this.updateFrame(),this.setContentPos(),this.configMotion()},e.prototype.startLoadAssets=function(){if(this._needLoadAssets&&!this._assetsHasLoaded){var t=this._frames;t&&RES.getResAsync(t,this.onAssetLoaded,this)}},e.prototype.onAssetLoaded=function(t,e){e==this._frames&&(this._needLoadAssets=!1,this._assetsHasLoaded=!0,this._datas=this.getAllTextures(t),this.refresh())},e.prototype.getAllTextures=function(t){var e,i,r=t._textureMap,n=[];for(var o in r)e=r[o],i=this.parseFrameKeyIndex(o),n[i-1]=e;return n},e.prototype.parseFrameKeyIndex=function(t){var i=t.lastIndexOf("_"),r=t.substring(i+1),n=parseInt(r);if(isNaN(n)){var o=r.match(e.FRAME_INDEX_REG);o&&(n=parseInt(o[o.length-1]))}return n},e.prototype.onRemoveFromStage=function(t){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this)},Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},set:function(t){this._frames!=t&&(this._frames=t,this._assetsHasLoaded=!1,null===t?(this._needLoadAssets=!1,this._datas=null):"string"==typeof this._frames?(this._needLoadAssets=!0,this._datas=null,this.stage&&this.startLoadAssets()):Array.isArray(this._frames)&&(this._needLoadAssets=!1,0==t.length?this._datas=null:this._datas=this._frames),this.refresh())},enumerable:!0,configurable:!0}),e.prototype.setLoopCount=function(t,e,i,r){this._loopCount=t,this._callBack=e,this._callBackParams=i,this._thisObj=r},e.prototype.configMotion=function(){this._playing&&this._fps&&this._datas?(this._delay=1e3/this._fps,this._needRnederPerFrame=!0):this._needRnederPerFrame=!1},e.prototype.play=function(){this._playing=!0,this._currRunNum=1,this.configMotion()},e.prototype.stop=function(){this._playing=!1,this.configMotion()},e.prototype.gotoAndPlay=function(t){this._currentFrame=t-1,this.updateFrame(),this.play()},e.prototype.gotoAndStop=function(t){this._currentFrame=t-1,this.updateFrame(),this.stop()},e.prototype.nextFrame=function(){++this._currentFrame,this.updateFrame()},e.prototype.prevFrame=function(){--this._currentFrame,this.updateFrame()},e.prototype.randomFrame=function(){this._currentFrame=Math.floor(Math.random()*(this.totalFrames+1)),this.updateFrame()},e.prototype.updateFrame=function(){if(0==this._totalFrames)return void(this._bitmap.texture=null);if(this._currentFrame>=this._totalFrames){if(this._currentFrame=0,this._loopCount)if(this._currRunNum>=this._loopCount){if(this.stop(),null!=this._callBack)return void this._callBack.apply(this._thisObj,this._callBackParams)}else++this._currRunNum}else this._currentFrame<0&&(this._currentFrame=this.totalFrames-1);this._bitmap&&(this._bitmap.texture=this._datas?this._datas[this._currentFrame]:null)},e.prototype.onTicker=function(t){this._needRnederPerFrame&&t-this._lastTickCount>=this._delay&&(this._lastTickCount=t,this._isRandom?this.randomFrame():this._reverse?this.prevFrame():this.nextFrame())},e.prototype.setContentPos=function(){if(this._bitmap.texture){var t=AnchorPointPosType.getAnchorPonumberByPosType(this._anchorPointType);this._bitmap.x=-this._bitmap.texture.textureWidth*t.x,this._bitmap.y=-this._bitmap.texture.textureHeight*t.y,this.setTxtPos()}else this._bitmap.x=0,this._bitmap.y=0},e.prototype.dispose=function(){BitmapMovieManager.instance.unRegiste(this),this.stop(),this._frames=null,this._datas=null,this._delay=0,this._fps=0,this._lastTickCount=0,this._needRnederPerFrame=!1,this._assetsHasLoaded=!1,this._needLoadAssets=!1,this._bitmap&&(this._bitmap.texture=null,this._bitmap=null),this._txt&&(this._txt=null)},Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this._currentFrame+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smoothing",{get:function(){return this._bitmap.smoothing},set:function(t){this._bitmap.smoothing=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._reverse},set:function(t){this._reverse=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRandom",{get:function(){return this._isRandom},set:function(t){this._isRandom=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fps",{get:function(){return this._fps},set:function(t){this._fps!=t&&(this._fps=t,this.configMotion())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchorPointType",{get:function(){return this._anchorPointType},set:function(t){this._anchorPointType=t,this.setContentPos()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return null==this._txt&&(this._txt=new eui.Label),this.addChild(this._txt),this._txt},enumerable:!0,configurable:!0}),e.prototype.setTxtPos=function(){this._txt&&this._bitmap.texture&&(this._txt.y=-(this._bitmap.texture.textureHeight/2)+this.bitmapOffx,this._txt.x=this._txt.scaleX*(.5*this._txt.textWidth*-1))},e.prototype.setTxtScaleX=function(t){this._txt&&(this._txt.scaleX=t)},Object.defineProperty(e.prototype,"bitmapOffx",{get:function(){return this._bitmapOffx},set:function(t){this._bitmapOffx=t},enumerable:!0,configurable:!0}),e.FRAME_INDEX_REG=/\d+/g,e}(eui.Component);__reflect(BitmapMovie.prototype,"BitmapMovie");var BitmapMovieManager=function(){function t(){this.dic=new SimpleMap,TimerManager.instance.doFrameLoop(1,this.updateAllBitmapMovie,this)}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.updateAllBitmapMovie=function(){var t=this;this._currentTickCount=TimerManager.instance.currTimer,this.dic.forEach(function(e,i){e.onTicker(t._currentTickCount)})},t.prototype.registe=function(t){this.dic.set(t,!0)},t.prototype.unRegiste=function(t){this.dic.set(t,null),this.dic["delete"](t)},t}();__reflect(BitmapMovieManager.prototype,"BitmapMovieManager");var ComboBox=function(t){function e(){var e=t.call(this)||this;return e._itemRender=TextItemRender,e._selectedIndex=-1,e._bounces=!1,e._alwaysShowScrollBar=!1,e._autoHideList=!0,e._textAligin="center",e._prompt="",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._textField.touchEnabled=!1,this._textField.text="",this._scroller.viewport=this._list,this._scroller.mask=this._maskSp,this._scroller.bounces=!1,this._scroller.scrollPolicyH=eui.ScrollPolicy.OFF,this._list.itemRenderer=this._itemRender,this._isShowList=!1,this._imgButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClickHandler,this),this._list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChange,this)},e.prototype.onChange=function(t){this._selectedIndex=this._list.selectedIndex,this.updateText(),this._autoHideList&&this.switchListShow(),this.dispatchEvent(new egret.Event(egret.Event.CHANGE))},Object.defineProperty(e.prototype,"prompt",{set:function(t){this._prompt=t,this._textField.text=this._prompt},enumerable:!0,configurable:!0}),e.prototype.updateText=function(){if(-1!=this._list.selectedIndex){var t=this._list.selectedItem;if("string"==typeof t)this._textField.text=t;else if("number"==typeof t)this._textField.text=t+"";else{if(!t.hasOwnProperty("label"))throw new Error("数据项中必须包含label属性");this._textField.text=t.label}}else this._textField.text=this._prompt},e.prototype.onBtnClickHandler=function(t){this.switchListShow()
},e.prototype.switchListShow=function(){this._isShowList?(egret.Tween.get(this._scroller).to({y:this._imgButton.height-this._scroller.height},300),this._isShowList=!1):(egret.Tween.get(this._scroller).to({y:this._imgButton.height},300),this._isShowList=!0)},e.prototype.commitProperties=function(){this._scroller.height=this.height-this._imgButton.height,this._scroller.y=this._imgButton.height-this._scroller.height,t.prototype.commitProperties.call(this)},Object.defineProperty(e.prototype,"dataProvider",{get:function(){return this._dataProvider},set:function(t){this._dataProvider!=t&&(this._dataProvider=t,this._list.dataProvider=t,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&null!=this._dataProvider&&(this._selectedIndex=t,this._list.selectedIndex=t,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItem",{get:function(){return this._list?this._list.selectedItem:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bounces",{get:function(){return this._bounces},set:function(t){this._scroller&&this._scroller.bounces!=t&&(this._bounces=t,this._scroller.bounces=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alwaysShowScrollBar",{get:function(){return this._alwaysShowScrollBar},set:function(t){this._scroller&&this._scroller.verticalScrollBar.autoVisibility!=t&&(this._alwaysShowScrollBar=t,this._scroller.verticalScrollBar.autoVisibility=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemRender",{set:function(t){t!=this._itemRender&&null!=t&&(this._itemRender=t,this._list.itemRenderer=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoHideList",{get:function(){return this._autoHideList},set:function(t){this._autoHideList=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAligin",{get:function(){return this._textAligin},set:function(t){this._textAligin=t,this._textField.textAlign=t},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(ComboBox.prototype,"ComboBox");var TextItemRender=function(t){function e(){var e=t.call(this)||this;return e.labelDisplay=null,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t)if("string"==typeof t)this.labelDisplay.text=t;else if("number"==typeof t)this.labelDisplay.text=t+"";else{if(!t.hasOwnProperty("label"))throw new Error("数据项中必须包含label属性");this.labelDisplay.text=t.label}else this.labelDisplay.text=""},e}(eui.ItemRenderer);__reflect(TextItemRender.prototype,"TextItemRender");var GEventDispatcher=function(){function t(){this._listenersDic={},this._thisObjToHandlersDic=new SimpleMap,this._pool=[]}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.addEventListener=function(t,e,i){if(!this.hasEventListener(t,e,i)){var r=this.getOneUnusedHandler();r.eventType=t,r.callBackFun=e,r.thisObj=i;var n=this._listenersDic[t];n?n.push(r):this._listenersDic[t]=[r];var o=this._thisObjToHandlersDic.get(i);null!=o?o.push(r):this._thisObjToHandlersDic.set(i,[r])}},t.prototype.dispatchEvent=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=this._listenersDic[t];if(null!=r){var n=r.length;if(0!=n)for(var o,s=n-1;s>=0;s--)o=r[s],null!=o&&o.execute(e)}},t.prototype.removeEventListener=function(t,e,i){var r,n,o=this._thisObjToHandlersDic.get(i),s=-1;if(o){n=o.length;for(var a=0;n>a;++a)if(r=o[a],r.eventType===t&&r.callBackFun===e){s=a;break}-1!=s&&(o.splice(s,1),0==o.length&&this._thisObjToHandlersDic["delete"](i))}if(o=this._listenersDic[t],s=-1,o){n=o.length;for(var a=0;n>a;++a)if(r=o[a],r.callBackFun===e&&r.thisObj===i){s=a;break}-1!=s&&(o.splice(s,1),r.clear(),this._pool.push(r),0==o.length&&delete this._listenersDic[t])}},t.prototype.removeAllEventListeners=function(t){var e=this;if(t){var i=this._listenersDic[t];i&&(i.forEach(function(t){var i=e._thisObjToHandlersDic.get(t.thisObj),r=-1;i&&(r=i.indexOf(t),-1!=r&&i.splice(r,1),0==i.length&&e._thisObjToHandlersDic["delete"](t.thisObj)),t.clear(),e._pool.push(t)}),i.length=0,delete this._listenersDic[t])}},t.prototype.hasTypeEventListener=function(t){return this._listenersDic[t]&&this._listenersDic[t].legth>0},t.prototype.hasEventListener=function(t,e,i){var r=this._thisObjToHandlersDic.get(i);if(!r)return!1;for(var n=null,o=0;o<r.length;o++)if(n=r[o],n.eventType===t&&n.callBackFun===e)return!0;return!1},t.prototype.getOneUnusedHandler=function(){return this._pool.length>0?this._pool.pop():new Handler},t}();__reflect(GEventDispatcher.prototype,"GEventDispatcher");var Handler=function(){function t(t,e,i){this.eventType=t,this.callBackFun=e,this.thisObj=i}return t.prototype.execute=function(t){this.callBackFun.apply(this.thisObj,t)},t.prototype.clear=function(){this.eventType=null,this.thisObj=null,this.callBackFun=null},t}();__reflect(Handler.prototype,"Handler");var TimerManager=function(){function t(){this._timerNum=0,this._pool=[],this._noPriorityHandlers=[],this._priorityHandlersArr=[],this._thisObjToTimerObjMap=new SimpleMap,this._currTimer=egret.getTimer(),this._currFrame=0,this._isUseBrowserHeartbeat=!1,this.init()}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){void 0===this._shape&&(this._shape=new egret.Shape,this._shape.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this))},Object.defineProperty(t.prototype,"useBrowserHeartbeat",{set:function(t){var e=this;this._isUseBrowserHeartbeat=t,t?(this._shape.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this._intervalId=setInterval(function(){e.onEnterFrame()},1e3/Global.FRAME_REAL_RATE)):(clearInterval(this._intervalId),this._shape.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this))},enumerable:!0,configurable:!0}),t.prototype.onEnterFrame=function(){this._currFrame+=1,this._currTimer=egret.getTimer();for(var t=null,e=0,i=this._noPriorityHandlers;e<i.length;e++)t=i[e],this.executeCallBack(t);for(var r=this._priorityHandlersArr.length-1;r>-1;r--)t=this._priorityHandlersArr[r],this.executeCallBack(t)},t.prototype.executeCallBack=function(t){var e=t.userFrame?this._currFrame:this._currTimer;if(e>=t.exeTime){var i=Math.floor((e-t.startTime)/t.delay)-t.currCount;t.exeTime+=i*t.delay;for(var r=0;i>r;r++)if(t.currCount++,t.ticker&&(t.ticker.apply(t.thisObj,t.args),t.maxCount>0&&t.currCount>=t.maxCount)){this.clearTimer(t.ticker,t.thisObj);break}}},t.prototype.doOnce=function(t,e,i,r,n){void 0===n&&(n=!0),this.create(!1,1,t,e,i,r,n)},t.prototype.doLoop=function(t,e,i,r,n,o,s){void 0===n&&(n=0),void 0===o&&(o=!0),void 0===s&&(s=0),this.create(!1,n,t,e,i,r,o,s)},t.prototype.doFrameOnce=function(t,e,i,r,n){void 0===n&&(n=!0),this.create(!0,1,t,e,i,r,n)},t.prototype.doFrameLoop=function(t,e,i,r,n,o,s){void 0===n&&(n=0),void 0===o&&(o=!0),void 0===s&&(s=0),this.create(!0,n,t,e,i,r,o,s)},t.prototype.create=function(t,e,i,r,n,o,s,a){if(void 0===s&&(s=!0),void 0===a&&(a=0),!s)throw new Error("定时器要允许覆盖，不然注册多个相同的定时器没意义");this.clearTimer(r,n),1>i&&r.apply(n,o);var l=this._pool.length>0?this._pool.pop():new TimerObject;l.userFrame=t,l.currCount=0,l.maxCount=e,l.delay=i,l.ticker=r,l.thisObj=n,l.args=o,l.startTime=t?this._currFrame:this._currTimer,l.exeTime=i+(t?this._currFrame:this._currTimer),a>0?(l.priority=a,this._priorityHandlersArr.push(l),this._priorityHandlersArr.sort(this.sortHandlerByPriority)):this._noPriorityHandlers.push(l);var h=this._thisObjToTimerObjMap.get(n);null!=h?h.push(l):this._thisObjToTimerObjMap.set(n,[l]),this._timerNum++},t.prototype.sortHandlerByPriority=function(t,e){return t.priority<e.priority?-1:t.priority>e.priority?1:0},t.prototype.clearTimer=function(t,e){var i=this._thisObjToTimerObjMap.get(e);if(null!=i){for(var r=null,n=!1,o=0,s=i;o<s.length;o++)if(r=s[o],r.ticker===t){n=!0;break}if(n){var a=this._noPriorityHandlers.indexOf(r);-1!=a?this._noPriorityHandlers.splice(a,1):(a=this._priorityHandlersArr.indexOf(r),-1!=a&&this._priorityHandlersArr.splice(a,1)),-1!=a&&(a=i.indexOf(r),i.splice(a,1),0==i.length&&this._thisObjToTimerObjMap["delete"](e)),r.clear(),this._pool.push(r),this._timerNum--}}},t.prototype.clearAllTimer=function(t){var e=this._thisObjToTimerObjMap.get(t);if(null!=e){for(var i,r=null,n=0,o=e;n<o.length;n++)r=o[n],i=this._noPriorityHandlers.indexOf(r),-1!=i?this._noPriorityHandlers.splice(i,1):(i=this._priorityHandlersArr.indexOf(r),-1!=i&&this._priorityHandlersArr.splice(i,1)),r.clear(),this._pool.push(r),this._timerNum--;e.length=0,this._thisObjToTimerObjMap["delete"](t)}},t.prototype.hasTimer=function(t,e){var i=this._thisObjToTimerObjMap.get(t);if(null!=i){for(var r=0,n=i;r<n.length;r++){var o=n[r];if(o.ticker===e)return!0}return!1}},Object.defineProperty(t.prototype,"count",{get:function(){return this._timerNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currTimer",{get:function(){return this._currTimer},enumerable:!0,configurable:!0}),t}();__reflect(TimerManager.prototype,"TimerManager");var TimerObject=function(){function t(){this.priority=0}return t.prototype.clear=function(){this.args=null,this.ticker=null},t}();__reflect(TimerObject.prototype,"TimerObject");